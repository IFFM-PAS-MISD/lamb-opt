
%% 
%% Copyright 2007, 2008, 2009 Elsevier Ltd
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for Elsevier's document class `elsarticle'
%% with harvard style bibliographic references
%% SP 2008/03/01

\documentclass[preprint,12pt]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times,authoryear]{elsarticle}
%% \documentclass[final,1p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,3p,times,authoryear]{elsarticle}
%% \documentclass[final,3p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,5p,times,authoryear]{elsarticle}
%% \documentclass[final,5p,times,twocolumn,authoryear]{elsarticle}

%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amsmath,amssymb,bm}
%\usepackage[dvips,colorlinks=true,citecolor=green]{hyperref}
\usepackage[colorlinks=true,citecolor=green]{hyperref}
%% my added packages
\usepackage{verbatim}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs} % for nice tables
%\usepackage{breqn}
% matrix command 
\newcommand{\matr}[1]{\mathbf{#1}} % bold upright (Elsevier, Springer)
% vector command 
\newcommand{\vect}[1]{\mathbf{#1}} % bold upright (Elsevier, Springer)
\newcommand{\ud}{\mathrm{d}}
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\veca}[2]{\mathbf{#1}{#2}}
\renewcommand{\bm}[1]{\mathbf{#1}}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\graphicspath{{figs/}{../../figures/}}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}
%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}
\journal{Composite Structures}
\begin{document}
	\begin{frontmatter}
		%% Title, authors and addresses
		%% use the tnoteref command within \title for footnotes;
		%% use the tnotetext command for theassociated footnote;
		%% use the fnref command within \author or \address for footnotes;
		%% use the fntext command for theassociated footnote;
		%% use the corref command within \author for corresponding author footnotes;
		%% use the cortext command for theassociated footnote;
		%% use the ead command for the email address,
		%% and the form \ead[url] for the home page:
		%% \title{Title\tnoteref{label1}}
		%% \tnotetext[label1]{}
		%% \author{Name\corref{cor1}\fnref{label2}}
		%% \ead{email address}
		%% \ead[url]{home page}
		%% \fntext[label2]{}
		%% \cortext[cor1]{}
		%% \address{Address\fnref{label3}}
		%% \fntext[label3]{}
		
		\title{Elastic constants identification of fibre-reinforced composites by using guided wave dispersion curves and genetic algorithm for improved simulations}
		
		%% use optional labels to link authors explicitly to addresses:
		%% \author[label1,label2]{}
		\address[IFFM]{Institute of Fluid Flow Machinery, Polish Academy of Sciences, Poland}
		
		\author{Pawel Kudela\corref{cor1}\fnref{IFFM}}
		\ead{pk@imp.gda.pl}
		\author{Maciej Radzienski\fnref{IFFM}}
		\author{Piotr Fiborek \fnref{IFFM}}
		%\ead{pfiborek@imp.gda.pl}
		\author{Tomasz Wandowski \fnref{IFFM}}	
		
		\cortext[cor1]{Corresponding author}
		
		\begin{abstract}
			%% Text of abstract
		Typically, material properties originate from destructive tests and are used in computational models in the design and analysis process of structures. This approach is well-established in relation to isotropic homogenous materials. However, if this approach is used for composite laminates, inaccuracies can arise that leads to vastly different stress distributions, strain rates, natural frequencies, and velocities of propagating elastic waves. In order to account for this problem, the alternative method is proposed, which utilizes Lamb wave propagation phenomenon and optimization technique. Propagating Lamb waves are highly sensitive to changes in material parameters and are often used for structural health monitoring of structures. In the proposed approach, the elastic constants, which are utilized to determine dispersion curves of Lamb waves, are optimized to achieve a good correlation between model predictions and experimental observations. In the first step of this concept, parametric studies have been carried out in which the influence of mass density, Young's modulus, Poisson's ratio of reinforcing fibres as well as matrix of composite laminate and volume fraction of reinforcing fibres on dispersion curves of Lamb waves was investigated. The effective elasticity constants were calculated by using micromechanics and homogenization techniques considering variability of properties of composite constituents. The dispersion curves of Lamb wave were calculated by using semi-analytical spectral element method. The resulting dispersion curves were also compared with experimental measurements of full wavefield data conducted by scanning Doppler laser vibrometer and processed by 3D Fourier transform. Elastic constants were further optimized by using genetic algorithm which resulted in good correlation between numerical and experimental dispersion curves.
		\end{abstract}
		
		\begin{keyword}
			%% keywords here, in the form: keyword \sep keyword
			Lamb waves \sep dispersion curves \sep semi-analytical spectral element method \sep composite laminates \sep elastic constants.
			%% PACS codes here, in the form: \PACS code \sep code
			
			%% MSC codes here, in the form: \MSC code \sep code
			%% or \MSC[2008] code \sep code (2000 is the default)
			
		\end{keyword}
		
	\end{frontmatter}
	
	%% \linenumbers
	
	%% main text
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\section{Introduction}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	Elastic constant values are often difficult to obtain, especially for anisotropic media. These values are indispensable for the design of a structure which fulfils assumed requirements (strength, stiffness, vibration characteristics). For years elastic constants of isotropic materials have been estimated during destructive testing and strain gauge or static displacement recordings~\cite{Wang2000}. Similar results can be achieved by dynamic tests which rely on natural frequencies~\cite{Wang2000a, Wesolowski2009,Beluch2014}. Measurements of velocities of bulk waves (longitudinal and shear) can also be used for determination of elastic constants~\cite{Rose1999}.
	
	For anisotropic media, determining the elastic constants is more complex. Destructive testing can still be used to determine some of the constants. Additional constants can be obtained by special cube-cutting procedures followed by destructive testing~\cite{Rose1991} or by using bulk wave measurement protocol for orthotropic media~\cite{Rose1999}. However, such experiments are cumbersome and expensive.  It should be noted that other ultrasonic methods exist such as leaky Lamb wave technique. In this technique, a specimen is immersed in a liquid tank and insonified with an acoustic beam at various incident angles and frequencies. The obtained pattern provides unique fingerprint of the underlying mechanical elasticity tensor at the insonified material spot.The method has been improved over the years by using the pulsed ultrasonic polar scan and inverse methods~\cite{Kersemans2014}. Due to simplicity, non-destructive methods based on one-sided Lamb wave propagation measurements have been evolving over the years.
	
	Lamb waves were named after their discoverer, Horace Lamb, who developed the theory of their propagation in 1917~\cite{Lamb1917}. Interestingly, Lamb was not able to physically generate the waves he discovered. This was achieved by Worlton~\cite{Worlton1961} in 1961, who also noticed their potential usefulness for damage detection. Lamb waves are defined as a type of elastic waves that propagate in infinite media bounded by two surfaces and arise as a result of the superposition of multiple reflections of longitudinal waves and shear vertical waves from the bounding surfaces. In the case of these waves, medium particle oscillations are very complex in character. Depending on the distribution of displacements on the top and bottom bounding surface, two modes of Lamb waves appear: symmetric, denoted as S0, S1, S2, …, and antisymmetric, denoted as A0, A1, A2, … One should note that the number of these modes is infinite.
	
	The analytic solution proposed by Lamb is limited to isotropic materials and infinite, unbounded media. The solution has highly nonlinear character, and numerical methods must be used to obtain dispersion curves. The numerical approach, based on Lamb solution, for calculation of dispersion curves for isotropic materials, can be found in a book by Rose~\cite{Rose1999}.
	
	Many studies have been devoted to the calculation of dispersion curves of Lamb waves propagating in composite laminates but only a few are related to the identification of elastic constants. Rose et al.~\cite{Rose1987} investigated Lamb wave propagation in unidirectional, two-directional, and quasi-isotropic graphite-epoxy composite panels. They derived polar characteristics of phase and group velocities of the low-frequency S0 Lamb mode. Mal et al.~\cite{Mal1993} and Karim et al.~\cite{Karim1990} determined dynamic elastic moduli of the fibre-reinforced composite. The elastic constants were derived by inversion of a set of data measured by the leaky Lamb wave technique. In 1995 Rogers~\cite{Rogers1995} proposed a technique to measure the isotropic elastic constants of plate materials using Rayleigh-Lamb waves. In his paper, he presents the effect of an increase in longitudinal wave velocities or changes in Young’s modulus or Poisson’s ratio on the dispersion curves.
	
	De\`an et al.~\cite{Dean2008} determined elastic constants and thickness of the aluminium by minimizing the error function comprised by the theoretical dispersion curves of Lamb waves and experimental data. They utilized full-field wavelength measurements of single-mode narrowband Lamb waves. Grinberg et al.~\cite{Grimberg2010} determined in-plane material parameters of CFRP from the equations for phase velocity of S0 and A0 modes at low-frequency range. 
	The paper by Bartoli et al.~\cite{Bartoli2006} deals with a semi-analytical finite element (SAFE) method for modelling wave propagation in waveguides of arbitrary cross-section. The method simply requires the finite element discretization of the cross-section of the waveguide and assumes harmonic motion along the wave propagation direction. The general SAFE technique is extended to account for viscoelastic material damping by allowing for complex stiffness matrices for the material. The dispersive solutions are obtained in terms of phase velocity, group velocity (for undamped media), energy velocity (for damped media), attenuation, and cross-sectional mode shapes. Taupin et al.~\cite{Taupin2011} applied the SAFE method to analyse composite laminate of various stacking sequences.
	
	A new semi-analytical method using 3-D elasticity theory was derived by Wang and Juan~\cite{Wang2007}. In comparison with the results of the theory and experiment, it was confirmed that multiple higher-order Lamb waves could be excited from piezoelectric actuators and the measured group velocities agree well with those from 3-D elasticity theory. The thin quasi-isotropic laminate was investigated only.
	
	Pol and Banerjee~\cite{Pol2013} derived a simplified 2D semi-analytical model based on a global matrix method to investigate the dispersion characteristics of propagating guided wave modes in multilayered composite laminates due to transient surface excitations. A relatively thin symmetric eight layered cross-ply composite laminate subjected to both narrowband and broadband surface excitations was considered. Comparison of group velocity curves obtained from developed model and LS-DYNA has shown good agreement.
	
	The paper by Beluch and Burczyński~\cite{Beluch2014} deals with the two-scale approach to the identification of material constants in composite materials. Structures made of unidirectionally fibre-reinforced composites are examined. However, for optimization of elastic constants, static displacements and eigenfrequencies are used, not Lamb wave data. Additionally, plane strain state was assumed in the model.
	
	In 2016 Ong et al.~\cite{Ong2016} proposed a technique for determination of elastic properties of the woven composite panel using the Lamb wave dispersion characteristics. The investigated CFRP panel comprised of 16 plies with such a sequence so that it could be treated as quasi-isotropic material. Simple 2D plane strain model was assumed in the numerical simulations. The material properties were found by fitting dispersion curves from a numerical simulation with experimental data by the particle swarm optimisation method. 
	
	From the review of the literature, no research evidence was found to date which deals with the rapid and robust identification of elastic material properties of highly anisotropic composite structures. Therefore, it is essential to develop a robust material identification methodology for the inspection of a wide range of composite structures. Moreover, there is no method which enables online tracking of changes in elastic material properties.
	
	The subject of this study focuses exclusively on an approach in which access to only one side of the specimen is required. In the proposed approach, dispersion curves of Lamb waves are utilized for determination of elastic constants in composite laminates. The paper is organized as follows: section~\ref{sec:dispersion_curves} describe numerical method for calculation of dispersion curves in laminated composites, section~\ref{sec:experiment} is related to extraction of dispersion curves from full wavefield measurements, section~\ref{sec:optimization} describes optimization of elastic constants by using genetic algorithm (GA) followed by conclusions.
	
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%	
\section{Dispersion curves of guided waves \label{sec:dispersion_curves}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Lamb wave dispersion phenomenon is related to wavenumber $k$ dependency on frequency $f$. 
Lamb wave dispersion curves depend on elasticity constants of the material in which Lamb waves propagate. 
Moreover, in composite laminates, dispersion curves depend the angle of propagation~\cite{Rose1999}. 
Therefore, these dependencies can be used for determination of elastic constants of composite laminates~\cite{Kudela2020}.
However, efficient model is needed for calculation of dispersion curves for a given material properties.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Semi-analytical model}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Since the time-domain spectral element method (SEM) model~\cite{Kudela2020a} usually contains a large number of degrees of freedom, it is difficult to incorporate it into optimisation process – computation of dispersion curves, which are a part of an objective function, would take too long. 
Therefore, Lamb wave dispersion characteristics are computed using a modified semi-analytical finite element method~\cite{Bartoli2006,Marzani2008}. 
The modification consists of the replacement of uniformly distributed nodes across the thickness by Gauss-Lobatto-Legendre (GLL) spectral nodes. 
Hence, we refer to the modified semi-analytical model as semi-analytical spectral element (SASE) model.
	
The mathematical model is presented here for the case of a plate-like waveguide as shown in Fig.~\ref{fig:layered_composite_SASE}.  
The waveguide made of orthotropic material is shown in Fig.~\ref{fig:layered_composite_SASE} in which reinforcing fibres are at angle $\theta$ in respect to $z$ axis.
One-dimensional spectral elements are applied through the thickness of a laminate, preserving wave equation in the propagation direction.  
Four-node spectral element is shown in Fig.~\ref{fig:layered_composite_SASE}. 
It has non-uniform distribution of nodes which coincide with GLL points and three degrees of freedom per node.
	
\begin{figure} [h!]
	\centering
	\includegraphics[width=\textwidth]{layered_composite_SASE3.png}
	%\includegraphics{layered_composite_SASE.png}	
	\caption{SASE model of wave propagation along with degrees of freedom of a one-dimensional four-node spectral element.}
	\label{fig:layered_composite_SASE}
\end{figure}
	
Additionally, according to the concept proposed by Taupin et~al.~\cite{Taupin2011}, equations for dispersion curves are derived so that the solution can be obtained for arbitrary angle of propagation $\beta$ shown in Fig.~\ref{fig:layered_composite_SASE}. 
The wave propagation direction corresponds to the wavevector $\vect{k}$ defined as:
	
\begin{equation}
	\vect{k} = k \cos (\beta)\hat{ \vect{x}} + k \sin (\beta) \hat{\vect{y}},
	\label{eq:wavevector}
\end{equation}
where \(\hat{ \vect{x}}\) and \(\hat{\vect{y}}\) are unit vectors. 	
The general wave equation has a form of eigenvalue problem:

\begin{equation}
	\left[\matr{A} - \omega^2\matr{M} \right] \vect{U} =0,
	\label{eq:eig_dispersion}
\end{equation}
where $\omega$ is the angular frequency, $\matr{M}$ is the mass matrix, $\matr{U}$ is the nodal displacement vector, and the matrix $\matr{A}$ can be defined as:
\begin{equation}
	\begin{aligned}
	\matr{A} & =  k^2\left(s^2 \,\matr{K}_{22} + c^2\, \matr{K}_{33} - c s\, \matr{K}_{23} - c s\, \matr{K}_{32}\right) \\
	& + i k\, \matr{T}^T\left(-c\, \matr{K}_{13} - s\, \matr{K}_{21} + s\, \matr{K}_{12} + c\, \matr{K}_{31}\right) \matr{T} +\matr{K}_{11},
	\end{aligned}
	\label{eq:dispersion}
\end{equation}
where  $s = \sin(\beta)$, $c = \cos(\beta)$, $i = \sqrt{-1}$, and $\beta$ is the angle of guided wave propagation. 
The transformation matrix $\matr{T}$ is diagonal and it is introduced in order to eliminate imaginary elements from Eq.~(\ref{eq:dispersion}) (see~\cite{Bartoli2006} for more details). 
It should be noted that the system of equations~(\ref{eq:eig_dispersion}) explicitly depends on the angle $\beta$. 
Predicting the anisotropic behaviour of guided wave properties makes it necessary to loop over $\beta$ for each direction considered.
	
Stiffness matrices $\matr{K}_{mn}$ from Eq.~(\ref{eq:dispersion}) depend on elastic constants of composite laminate $\matr{C}$ and relations between displacements and strains. 
The definitions of these matrices on an elemental level are:
\begin{equation}
	\matr{K}_{mn}^e= \int \limits_{(e)} \matr{B}_m^{T} \matr{C}_{\theta}^e \, \matr{B}_n\, \ud z, 
	\label{eq:stiffness_matrix_e}
\end{equation}
where \(\matr{C}_{\theta}\) is the elastic tensor at element (e) transformed by an angle \(\theta\) according to a stacking sequence: $ \matr{C}_{\theta}= \matr{R}_1(\theta) \,\matr{C} \,\matr{R}_2^{-1}(\theta)$; \(\matr{B}\) is the matrix relating displacements and strains.
More detailed derivation can be found in~\cite{Kudela2020}. 

The matrix of elastic constants of an orthotropic linear elastic material can be written as:
\begin{equation}
	\matr{C} = \left[\begin{array}{cccccc} C_{11} & C_{12}& C_{13} & 0&0&0\\[2pt]
		C_{12}& C_{22} & C_{23}& 0&0&0\\[2pt]
		C_{13}&C_{23}&C_{33}&0&0&0\\[2pt]
		0& 0 &0&C_{44}& 0&0\\[2pt]
		0&0&0&0&C_{55}&0\\[2pt]
		0&0&0&0&0&C_{66}
	\end{array}\right]. 
	\label{eq:elastic_constatns}
\end{equation} 
It means that there are 9 independent coefficients which should be determined by using an inverse method. 
	
Equation~(\ref{eq:eig_dispersion}) can be solved numerically in two ways:
\begin{itemize}
	\item as a standard eigenvalue problem $\omega (k)$ (assuming given real values of wavenumbers $k$)
	\item as a second-order polynomial eigenvalue problem $k(\omega)$ for given frequencies $\omega$.
\end{itemize}
In the former case, the standard eigenvalue problem has a form:
\begin{equation}
	\left[\matr{A} - \omega^2\matr{M} \right]_{m} \vect{U} =0,
	\label{eq:eig_standard}
\end{equation}
in which the number of equations is $m$.
In the later case, the solution consist of recasting Eq.~(\ref{eq:eig_standard}) to a first-order eigensystem by doubling its algebraic size:
\begin{equation}
	\left[\hat{\matr{A}} - k \hat{\matr{D}} \right]_{2m} \hat{\vect{Q}} =0,
	\label{eq:eig_poly}
\end{equation}  
where
\begin{equation*}
	\hat{\vect{Q}} =\left[\begin{array}{c} 
		\vect{U}\\
		k \vect{U}
	\end{array} \right]
\end{equation*}
\begin{flalign*}
	&\hat{\matr{A}} =\left[\begin{array}{cc} 
		0 & \matr{K}_{11} - \omega^2 \matr{M}\\
		\matr{K}_{11} - \omega^2 \matr{M} & -i \left( c	\, \matr{K}_{13} - s\, \matr{K}_{12}  + s\, \matr{K}_{21} - c \, \matr{K}_{31}   \right)
	\end{array} \right]   \\
	&\hat{\matr{D}} =\left[\begin{array}{cc} 
		\matr{K}_{11} - \omega^2 \matr{M} & 0\\
		0& - \left( s^2 \, \matr{K}_{22} + c^2 \,  \matr{K}_{33}  -s c \,  \matr{K}_{23}  -sc \, \matr{K}_{32}  \right)
	\end{array} \right]
\end{flalign*}
The obtained wavenumbers are then of a complex character. 
It provides information about both the wave dispersion (real part of the wavenumbers) and the attenuation of the waves (imaginary part of the wave numbers). 
Unfortunately, solving a second‐order polynomial eigenvalue problem is about 10 times more costly than solving a standard eigenvalue problem. 

Linear frequencies $f=\omega/(2 \pi)$ will be used in next sections instead of angular frequencies $\omega$ for easier interpretation of figures.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Strategies for determination of material properties}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Dispersion curves calculated numerically must be accompanied by experimental counterpart to build appropriate objective function. 
In this paper we consider guided waves acquired at dense grid of points on the surface of a plate which forms full wavefield data set. 

Full wavefield data set can be acquired by scanning laser Doppler vibrometer (SLDV).
It is a 3D matrix representing spatial dimensions $x$, $y$ and the time $t$. 
3D Fourier transform leads to wavenumber-wavenumber-frequency representation  in the Cartesian coordinate system ($k_x$, $k_y$, $f$) or wavenumber-angle-frequency representation  in the cylindrical coordinate system ($k$, $\beta$, $f$).

Three strategies can be applied:
\begin{itemize}
	\item utilise data set at selected angle slices,
	\item utilise data set at selected frequency slices,
	\item use mixed approach (not considered here).
\end{itemize}
The slices of wavenumber-wavenumber-frequency data at selected wave propagation angles ($\beta=30^{\circ}$, $\beta=90^{\circ}$) are presented in Figure 2. 
The slices reveal patterns which represent characteristic dispersion curves. 
Corresponding numerical dispersion curves can be computed quite fast by the semi-analytic method by swept over real wavenumber range.
Equation~(\ref{eq:eig_standard}) is used in this strategy.

The data slices at frequencies 100 kHz and 350 kHz are shown in Figure 3. 
The elliptic-like pattern of wavenumbers is visible (wavenumber surface).
In this case Eq.~(\ref{eq:eig_poly}) is more appropriate for calculation of equivalent numerical wavenumber curves but it requires longer computation time as mentioned before.

\begin{figure} [h!]
	\centering
	\includegraphics{angle_slice.png}	
	\caption{Experimental wavenumber-wavenumber-frequency data sliced at chosen angles ($\beta=30^{\circ}$ and $\beta=90^{\circ}$).}
	\label{fig:angle_slice}
\end{figure}

\begin{figure} [h!]
	\centering
	\includegraphics{freq_slice.png}	
	\caption{Experimental wavenumber-wavenumber-frequency data sliced at chosen frequencies (100 kHz and 350 kHz).}
	\label{fig:freq_slice}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\section{Guided wave modelling improvement through identification of elastic constants of unidirectional CFRP} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Specimen}
The investigated specimen had dimensions 1200 $\times$ 1200 mm and was made out of carbon fibre-reinforced polymer (CFRP). 
The average thickness was 2.85 mm.
The total weight of the specimen was 6460 g, hence, based on the volume of the specimen, the density is about~1574.1~kg/m\textsuperscript{3}.
The specimen was composed of 40 layers of unidirectional prepregs stacked in one direction (90 degrees). 
NTPT thin prepregs 736LT 75~g/m$^2$ by North Thin Ply Technology and epoxy resin MP503Z-HT by Impregnatex Compositi were used for fabrication of the specimen.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Experimental setup}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% laser vibrometer mesurements
Piezoelectric transducer disc of 10 mm diameter  was bonded to the surface of the specimen at their centre. 
A chirp signal was applied to piezoelectric transducer. 
Full wavefield measurements of guided waves were conducted by using scanning laser Doppler vibrometer (Polytec PSV-400) on the central area of width 0.726 m and length 0.726 m. 
A grid of 499 $\times$ 499 measurement point covering surface of the specimen opposite to the piezoelectric transducer was used. 
40 measurements were taken for each grid point and averaged.

3D Fourier Transform was applied to the full wavefield data in the space-time domain ($x$, $y$, $t$). 
Next 3D matrix was transformed from ($k_x$, $k_y$, $\omega$) coordinates to cylindrical coordinates ($\beta$,$k$,$f$). 
Interpolation was employed to obtain 2D images ($k$,$f$) representing dispersion curves $k(f)$ at selected angles $\beta = 0^{\circ} \ldots 90^{\circ}$ with the step of $15^{\circ}$, resulting in 9 2D matrices. 
Let's denote these matrices representing dispersion curves by $\matr{D}_{\beta}$. 
The size of the matrix  $\matr{D}_{\beta}$ in the current approach was $n_k=512$ $\times$$n_f= 512$, where $n_k$ is the number of wavenumber points and $n_f$ is the number of frequency points.  
An example of such matrix at angle $ 60^{\circ}$ is presented in Fig.~\ref{fig:initial_optimized}. 
Dispersion curves in Fig.~\ref{fig:dispersion60deg_initial} calculated by using SASE model and material properties given in Table~\ref{tab:matprop} in the form of yellow curves are overlayed on the image for reference. 
It can be seen that there is high discrepancy between semi-analytic dispersion curves and experimental one. 
% overlayed = superimposed
\subsection{SEM model}
\subsection{Determination of elastic constants}
\subsection{SEM model accuracy analysis}
\subsection{Full wavefield comparison}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Validation on quasi-isotropic CFRP}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Specimen}
\subsection{Experimental setup}
\subsection{Determination of elastic constants}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Experimental measurements \label{sec:experiment}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\section{Optimization \label{sec:optimization}}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	The Sheffield Genetic Algorithm Toolbox for Matlab developed at Department of Automatic Control and Systems Engineering at The University of Sheffield was used for the optimization~\cite{Chipperfield1994}.
	\subsection{Genetic algorithm parameters}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	Two approaches were considered:
	\begin{enumerate}
	\item indirect - by using composite constituents and homogenisation techniques;
	The genetic algorithm was used for determination of the following properties:  matrix density $\rho_m$, fibres density $\rho_f$, matrix Young's modulus $E_m$, fibres Young's modulus $E_f$, Poisson's ratio of the matrix $\nu_m$, Poisson's ratio of the fibres $\nu_f$ and volume fraction of reinforcing fibres $V$. 
	\item direct - determination of C-tensor components and mass density.
	The genetic algorithm was used for determination of the following properties: $C_{11}$, $C_{12}$, $C_{13}$,  $C_{22}$, $C_{23}$, $C_{33}$, $C_{44}$, $C_{55}$, $C_{66}$ and $\rho$.
	\end{enumerate}
	The overall density of composite specimen $\rho$ was not evaluated experimentally and that is why it is included in the list of optimization variables.
	The following GA parameters were used for optimization:
	\begin{itemize}
		\item Number of individuals per subpopulation: 40
		\item Maximum number of generations: 40
		\item Generation gap: 0.9
		\item Number of variables in objective function: 7 (approach~1), 10 (approach~2)
		\item Precision of binary representation of variables: 12 bit
		\item Gray coding was used for representation of each variable.
   \end{itemize}
    Generation gap of 0.9 means that 90\% chromosomes from old population is replaced by 90\% best found chromosomes from new population while preserving 10\% best found chromosomes from old population into new population.
    
    It should be noted that 12 bits precision was used for each variable. However, according to parametric studies in section~\ref{sec:parametric} certain material properties such as Poisson's ratio of reinforcing fibres have less influence on dispersion curves, hence the precision for their representation can be decreased. In contrast, volume fraction of reinforcing fibres has greatest influence on dispersion curves, hence the precision of representation of this variable can be increased.
  
	Upper and lower bounds of variables were set as  $\pm$20\% in respect to initial values given in Table~\ref{tab:matprop}.
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\subsection{Objective function}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	The optimization problem can be described as a minimization of objective function as follows:
	\begin{equation}
	\min_j \sum_{\beta}\sum_{m} \| k^{SASE}_{m}(\beta, \omega,\matr{C}^{(j)}) -k^{exp}_{m}(\beta,\omega) \|
	\end{equation}
	where $m$ denotes the mode of propagating wave.
	The objective function is correlation between dispersion curves calculated by using SASE model $k^{SASE}_{m}(\beta, \omega,\matr{C}^{(j)})$ and dispersion curves from experiment $k^{exp}_{m}(\beta,\omega)$. However, in the model we have actual curves for each propagation mode $m$ depending on the matrix of elastic constants $\matr{C}^{(j)}$ and propagation angle $\beta$ but the data from the experiment have a form of a matrix (image) $\matr{D}^{exp}_{\beta}$ at each angle $\beta$ (see Fig.~\ref{fig:initial_optimized}). Extraction of dispersion curves $k^{exp}_{m}(\beta,\omega)$ from images $\matr{D}^{exp}_{\beta}$ is cumbersome and could lead to inherent errors. Moreover, in order to formulate correlation coefficient, dispersion curves in SASE model must be sorted (which increases computation costs). Therefore, dispersion curves corresponding to modes $m=1,\ldots, 4$ calculated by using SASE model were converted to image $\matr{D}^{SASE}_{\beta} $ in which dimensions are the same as in experiment ($n_k=512$ $\times$$n_f= 512$). Pixels of image $\matr{D}^{SASE}_{\beta} $ which corresponds to dispersion curves are assigned value 1 whereas the remaining pixels have value 0. It leads to logic matrix or mask which can be applied for filtering experimental images: 
	\begin{equation}
		\tilde{\matr{D}}^{\beta} =  \matr{D}^{SASE}_{\beta}  .*    \matr{D}^{exp}_{\beta} ,
   \end{equation}	
    where $.*$ is the element wise multiplication (such notation is used in Matlab). If dispersion curves from SASE model align well with high values of experimental images, it leads to high values in filtered image and vice versa.
	The objective function value can be finally calculated as: 
	\begin{equation}
	\tilde{F} = \frac{(-1)}{n_k \, n_f}  \cdot \sum_{\beta}  \sum_{i=1}^{n_k} \sum_{j=1}^{n_f}	\tilde{D}_{ij}^{\beta} 
	\end{equation}
	In this way rich experimental data is fully used and roots sorting of SASE dispersion curves is not necessary. Additionally, objective function scaling can be applied in the form:
	\begin{equation}
	F = a \,  \tilde{F} + b,
	\end{equation}
	where $a$ and $b$ are scaling parameters ($a=100$, $b=310$ were assumed in the current studies).
		% rich data
	% logical matrix
	
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%	
	\subsection{Results}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{figure} [h!]
		\centering
		\begin{subfigure}[b]{\textwidth}
			\centering
			% size fitted
			%\includegraphics[width=\textwidth]{dispersion60deg_initia.png}
			% size 100%
			\includegraphics[]{dispersion60deg_initial.png}
			\caption{initial parameters}
			\label{fig:dispersion60deg_initial}
		\end{subfigure}
		\begin{subfigure}[b]{\textwidth}
			\centering
			% size fitted
			%\includegraphics[width=\textwidth]{dispersion60deg.png}
			% size 100%
			\includegraphics[]{dispersion60deg}
			\caption{optimized}
			\label{fig:dispersion60deg}
		\end{subfigure}
	\caption{Dispersion curves at angle $\beta = 60^{\circ}$; yellow curves: SASE model; image: experiment }
	\label{fig:initial_optimized}
	\end{figure}
\clearpage

 \begin{table}[h]
	\renewcommand{\arraystretch}{1.3}
	\centering \footnotesize
	\caption{GA optimization results based on statistics (mean $\mu$ and standard deviation $\sigma$) of 100 GA runs; Elasticity constants [GPa].}
	%\begin{tabular}{@{}ccccccc@{}} % remove spaces from vertical lines
	\begin{tabular}{crrrrrr} 
		%\hline
		\toprule
		&\multicolumn{3}{c}{\textbf{indirect method} }	& \multicolumn{3}{c}{\textbf{direct method} }  \\ 
		%	\hline \hline
		\midrule
		&Best & $\mu$ & $\sigma$& Best& $\mu$ & $\sigma$\\
		\cmidrule(lr){2-4} \cmidrule(lr){5-7} 
		%\hline
		$C_{11}$&50.19&1.10& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		$C_{12}$&4.88&0.97& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		$C_{13}$&1.0&1.0& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		$C_{22}$&1.0&1.0& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		$C_{23}$&1.0&1.0& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		$C_{33}$&1.0&1.0& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		$C_{44}$&1.0&1.0& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		$C_{55}$&1.0&1.0& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		$C_{66}$&1.0&1.0& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		$F$          &1.0&1.0& 1.0  & 1.0  & 1.0 & 1.0 \\ 
		%\hline 
		\bottomrule 
	\end{tabular} 
	\label{tab:results}
\end{table}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\section{Conclusions}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

	
	In summary, the current implementation is very well suited for 
	 
	%% The Appendices part is started with the command \appendix;
	%% appendix sections are then done as normal sections
	%\appendix
	 
	\section*{Acknowledgement}
   The research was funded by the Polish National Science Center under grant agreement no 2018/29/B/ST8/00045. 
	
	
	
	%% If you have bibdatabase file and want bibtex to generate the
	%% bibitems, please use
	%%
	%%  \bibliographystyle{elsarticle-harv} 
	%%  \bibliography{<your bibdatabase>}
	
	%% else use the following coding to input the bibitems directly in the
	%% TeX file.
	%\section*{Reference}
    \bibliographystyle{num_order}
	\bibliography{2021-Identification-GA}{}

\end{document}


